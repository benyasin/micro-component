<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="980" height="560" viewBox="0 0 980 560">
  <defs>
    <style>
      .box{fill:#fff;stroke:#2f6feb;stroke-width:2;rx:10;ry:10}
      .sub{fill:#f6f8fa;stroke:#8c959f;stroke-width:1.5;rx:8;ry:8}
      .label{font:14px -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";fill:#0f172a}
      .small{font:12px -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial;fill:#334155}
      .title{font:16px -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial;font-weight:600;fill:#111827}
      .arrow{stroke:#64748b;stroke-width:1.8;marker-end:url(#arrow)}
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="8" refX="8" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,4 L0,8 Z" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Host Apps -->
  <rect class="box" x="40" y="40" width="280" height="140"/>
  <text class="title" x="60" y="68">宿主应用（任一前端栈）</text>
  <text class="small" x="60" y="92">• Vue 3 / Vue 2 / React</text>
  <text class="small" x="60" y="112">• 正常以组件方式使用</text>

  <!-- Wrappers -->
  <rect class="sub" x="40" y="200" width="280" height="140"/>
  <text class="title" x="60" y="228">包装器（Wrapper）</text>
  <text class="small" x="60" y="252">• 适配各栈的 props/事件/插槽</text>
  <text class="small" x="60" y="274">• 归一到统一协议：{ type, props, el, on }</text>

  <!-- Protocol -->
  <rect class="sub" x="360" y="200" width="240" height="140"/>
  <text class="title" x="380" y="228">统一协议层</text>
  <text class="small" x="380" y="252">• Props 规范化（扁平/可序列化）</text>
  <text class="small" x="380" y="274">• 事件：onXxx / $listeners → bridge</text>
  <text class="small" x="380" y="296">• 生命周期对齐：mount/update/unmount</text>

  <!-- Runtime -->
  <rect class="box" x="640" y="40" width="300" height="140"/>
  <text class="title" x="660" y="68">MicroRuntime（统一内核）</text>
  <text class="small" x="660" y="92">• 基于 Vue 3 作为渲染内核</text>
  <text class="small" x="660" y="112">• Teleport 到宿主提供的 el</text>

  <!-- Renderer/Resources -->
  <rect class="sub" x="640" y="200" width="300" height="140"/>
  <text class="title" x="660" y="228">资源与渲染</text>
  <text class="small" x="660" y="252">• 动态 import 组件 JS</text>
  <text class="small" x="660" y="272">• 注入/去重 CSS 与主题</text>
  <text class="small" x="660" y="292">• 加载 i18n 与数据（可并发）</text>

  <!-- Event Bridge -->
  <rect class="sub" x="360" y="360" width="580" height="120"/>
  <text class="title" x="380" y="388">事件桥与可观测</text>
  <text class="small" x="380" y="412">• 组件 → Runtime → 包装器 → 宿主回调</text>
  <text class="small" x="380" y="432">• 统一派发 CustomEvent: MicroRuntime:Metric</text>
  <text class="small" x="380" y="452">• 超时/降级/缓存 保证稳定性</text>

  <!-- Arrows -->
  <line class="arrow" x1="180" y1="180" x2="180" y2="200"/>
  <line class="arrow" x1="320" y1="270" x2="360" y2="270"/>
  <line class="arrow" x1="480" y1="200" x2="780" y2="180"/>
  <line class="arrow" x1="780" y1="180" x2="780" y2="200"/>
  <line class="arrow" x1="640" y1="260" x2="600" y2="420"/>
  <line class="arrow" x1="320" y1="270" x2="320" y2="420"/>
  <line class="arrow" x1="180" y1="340" x2="360" y2="420"/>
</svg>