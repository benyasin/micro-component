<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="1000" viewBox="0 0 1200 1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      * { outline: none !important; }
      text { outline: none !important; }
      rect { outline: none !important; }
      g { outline: none !important; }
    </style>
    <linearGradient id="hostGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="wrapperGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffcc02;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="runtimeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4caf50;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="resourceGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#9c27b0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="eventGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff8e1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ff9800;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#00000020"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- 背景 -->
  <rect width="1200" height="1400" fill="#fafafa"/>



  <!-- 宿主应用层 -->
  <g transform="translate(50, 80)">
    <rect width="1100" height="120" rx="8" fill="url(#hostGrad)" filter="url(#shadow)"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      宿主应用层 (Host Applications)
    </text>

    <!-- Vue2 项目 -->
    <g transform="translate(50, 50)">
      <rect width="300" height="50" rx="6" fill="#fff" stroke="#1976d2" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1976d2">Vue2 项目</text>
      <text x="150" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">
        &lt;MicroButton @click="handler" /&gt;
      </text>
    </g>

    <!-- Vue3 项目 -->
    <g transform="translate(400, 50)">
      <rect width="300" height="50" rx="6" fill="#fff" stroke="#4caf50" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4caf50">Vue3 项目</text>
      <text x="150" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">
        &lt;MicroButton @click="handler" /&gt;
      </text>
    </g>

    <!-- React 项目 -->
    <g transform="translate(750, 50)">
      <rect width="300" height="50" rx="6" fill="#fff" stroke="#ff9800" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ff9800">React 项目</text>
      <text x="150" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">
        &lt;MicroButton onClick={handler} /&gt;
      </text>
    </g>
  </g>

  <!-- 包装器层 -->
  <g transform="translate(50, 240)">
    <rect width="1100" height="180" rx="8" fill="url(#wrapperGrad)" filter="url(#shadow)"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      包装器层 (Wrapper Layer) - 框架差异抹平
    </text>

    <!-- Vue2 包装器 -->
    <g transform="translate(50, 50)">
      <rect width="300" height="110" rx="6" fill="#fff" stroke="#ff9800" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ff9800">Vue2 包装器</text>
      <text x="10" y="40" font-family="Arial, sans-serif" font-size="10" fill="#666">• 语法转换: @click → onClick</text>
      <text x="10" y="55" font-family="Arial, sans-serif" font-size="10" fill="#666">• 生命周期: mounted → onMounted</text>
      <text x="10" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666">• Props 适配: :prop → prop</text>
      <text x="10" y="85" font-family="Arial, sans-serif" font-size="10" fill="#666">• 事件桥接: $emit → emit</text>
      <text x="10" y="100" font-family="Arial, sans-serif" font-size="10" fill="#666">• DOM 容器: this.$el</text>
    </g>

    <!-- Vue3 包装器 -->
    <g transform="translate(400, 50)">
      <rect width="300" height="110" rx="6" fill="#fff" stroke="#4caf50" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4caf50">Vue3 包装器</text>
      <text x="10" y="40" font-family="Arial, sans-serif" font-size="10" fill="#666">• 语法保持: @click → onClick</text>
      <text x="10" y="55" font-family="Arial, sans-serif" font-size="10" fill="#666">• 生命周期: onMounted → onMounted</text>
      <text x="10" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666">• Props 直通: :prop → prop</text>
      <text x="10" y="85" font-family="Arial, sans-serif" font-size="10" fill="#666">• 事件直通: emit → emit</text>
      <text x="10" y="100" font-family="Arial, sans-serif" font-size="10" fill="#666">• DOM 容器: ref</text>
    </g>

    <!-- React 包装器 -->
    <g transform="translate(750, 50)">
      <rect width="300" height="110" rx="6" fill="#fff" stroke="#1976d2" stroke-width="2"/>
      <text x="150" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1976d2">React 包装器</text>
      <text x="10" y="40" font-family="Arial, sans-serif" font-size="10" fill="#666">• 语法转换: onClick → onClick</text>
      <text x="10" y="55" font-family="Arial, sans-serif" font-size="10" fill="#666">• 生命周期: useEffect → onMounted</text>
      <text x="10" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666">• Props 适配: prop={value} → prop</text>
      <text x="10" y="85" font-family="Arial, sans-serif" font-size="10" fill="#666">• 事件桥接: callback → emit</text>
      <text x="10" y="100" font-family="Arial, sans-serif" font-size="10" fill="#666">• DOM 容器: useRef</text>
    </g>
  </g>

  <!-- 统一协议层 -->
  <g transform="translate(50, 460)">
    <rect width="1100" height="100" rx="8" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      统一协议层 (Unified Protocol)
    </text>

    <text x="50" y="50" font-family="Arial, sans-serif" font-size="12" fill="#333">
      <tspan x="50" dy="0">• Props 规范化: { type, props, el, on }</tspan>
      <tspan x="50" dy="20">• 事件统一: onXxx → emit('xxx', payload)</tspan>
      <tspan x="50" dy="20">• 生命周期对齐: mount/update/unmount</tspan>
    </text>

    <text x="600" y="50" font-family="Arial, sans-serif" font-size="12" fill="#333">
      <tspan x="600" dy="0">• 可序列化数据</tspan>
      <tspan x="600" dy="20">• 跨框架兼容</tspan>
      <tspan x="600" dy="20">• 统一事件桥</tspan>
    </text>
  </g>

  <!-- 运行时层 -->
  <g transform="translate(50, 600)">
    <rect width="1100" height="150" rx="8" fill="url(#runtimeGrad)" filter="url(#shadow)"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      运行时层 (Runtime Layer) - Vue3 统一内核
    </text>

    <!-- MicroRuntime -->
    <g transform="translate(50, 50)">
      <rect width="500" height="80" rx="6" fill="#fff" stroke="#4caf50" stroke-width="2"/>
      <text x="250" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4caf50">MicroRuntime (Vue3 内核)</text>
      <text x="10" y="40" font-family="Arial, sans-serif" font-size="10" fill="#666">• 组件创建: createComponent({ type, props, el })</text>
      <text x="10" y="55" font-family="Arial, sans-serif" font-size="10" fill="#666">• Teleport 渲染: 渲染到外部容器</text>
      <text x="10" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666">• 事件调度: 统一事件总线</text>
    </g>

    <!-- 资源管理 -->
    <g transform="translate(600, 50)">
      <rect width="450" height="80" rx="6" fill="#fff" stroke="#9c27b0" stroke-width="2"/>
      <text x="225" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#9c27b0">资源与渲染管理</text>
      <text x="10" y="40" font-family="Arial, sans-serif" font-size="10" fill="#666">• 动态 import 组件 JS</text>
      <text x="10" y="55" font-family="Arial, sans-serif" font-size="10" fill="#666">• 注入/去重 CSS 与主题</text>
      <text x="10" y="70" font-family="Arial, sans-serif" font-size="10" fill="#666">• 加载 i18n 与数据</text>
    </g>
  </g>

  <!-- 事件桥与可观测性 -->
  <g transform="translate(50, 790)">
    <rect width="1100" height="120" rx="8" fill="url(#eventGrad)" filter="url(#shadow)"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      事件桥与可观测性 (Event Bridge &amp; Observability)
    </text>

    <text x="50" y="50" font-family="Arial, sans-serif" font-size="12" fill="#333">
      <tspan x="50" dy="0">• 组件 → Runtime → 包装器 → 宿主回调</tspan>
      <tspan x="50" dy="20">• 统一派发 CustomEvent: MicroRuntime: Metric</tspan>
      <tspan x="50" dy="20">• 超时/降级/缓存 保证稳定性</tspan>
    </text>
  </g>

  <!-- 数据流箭头 -->
  <!-- 宿主到包装器 -->
  <g stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="200" y1="200" x2="200" y2="240"/>
    <line x1="550" y1="200" x2="550" y2="240"/>
    <line x1="900" y1="200" x2="900" y2="240"/>
  </g>

  <!-- 包装器到协议层 -->
  <g stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="200" y1="420" x2="200" y2="460"/>
    <line x1="550" y1="420" x2="550" y2="460"/>
    <line x1="900" y1="420" x2="900" y2="460"/>
  </g>

  <!-- 协议层到运行时 -->
  <g stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="300" y1="560" x2="300" y2="600"/>
    <line x1="550" y1="560" x2="550" y2="600"/>
    <line x1="800" y1="560" x2="800" y2="600"/>
  </g>

  <!-- 运行时到事件桥 -->
  <g stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <line x1="300" y1="750" x2="300" y2="790"/>
    <line x1="550" y1="750" x2="550" y2="790"/>
    <line x1="800" y1="750" x2="800" y2="790"/>
  </g>


</svg>
