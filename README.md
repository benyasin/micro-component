# Micro Components - è·¨æ ˆå¾®ç»„ä»¶ç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº Vue 3 çš„è·¨æ ˆå¾®ç»„ä»¶ç³»ç»Ÿï¼Œæ”¯æŒåœ¨ Vue 2ã€Vue 3 å’Œ React é¡¹ç›®ä¸­æ— ç¼ä½¿ç”¨ç›¸åŒçš„ç»„ä»¶ã€‚ç³»ç»Ÿé€šè¿‡è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å’Œç»„ä»¶é€šä¿¡æœºåˆ¶ï¼Œå®ç°äº†çœŸæ­£çš„è·¨æ¡†æ¶ç»„ä»¶å¤ç”¨ã€‚

## æ ¸å¿ƒç‰¹æ€§

- ğŸš€ **è·¨æ ˆæ”¯æŒ**: æ”¯æŒ Vue 2ã€Vue 3ã€React é¡¹ç›®
- ğŸ”„ **è¿è¡Œæ—¶åŠ è½½**: ç»„ä»¶æŒ‰éœ€åŠ¨æ€åŠ è½½ï¼Œæ”¯æŒä¼˜å…ˆçº§é˜Ÿåˆ—
- ğŸ¯ **ç»„ä»¶é€šä¿¡**: åŸºäºäº‹ä»¶ç³»ç»Ÿçš„ç»„ä»¶é—´é€šä¿¡
- ğŸŒ **å›½é™…åŒ–**: å†…ç½®å¤šè¯­è¨€æ”¯æŒï¼Œæ”¯æŒè¿è¡Œæ—¶è¯­è¨€åˆ‡æ¢
- ğŸ¨ **ä¸»é¢˜ç³»ç»Ÿ**: æ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢
- ğŸ“¦ **æ¨¡å—åŒ–**: ç»„ä»¶ç‹¬ç«‹æ‰“åŒ…ï¼Œæ”¯æŒä»£ç åˆ†å‰²
- ğŸ”§ **å¼€å‘å‹å¥½**: æ”¯æŒçƒ­é‡è½½ã€è°ƒè¯•æ¨¡å¼

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®¿ä¸»åº”ç”¨ (Host App)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Vue 2     â”‚  â”‚   Vue 3     â”‚  â”‚   React     â”‚         â”‚
â”‚  â”‚  é¡¹ç›®       â”‚  â”‚  é¡¹ç›®       â”‚  â”‚  é¡¹ç›®       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å¾®ç»„ä»¶åŒ…è£…å™¨ (Wrapper)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Vue2 Wrapperâ”‚  â”‚ Vue3 Wrapperâ”‚  â”‚React Wrapperâ”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è¿è¡Œæ—¶ç³»ç»Ÿ (Runtime)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              MicroRuntime                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ ç»„ä»¶ç®¡ç†å™¨   â”‚  â”‚ äº‹ä»¶ç³»ç»Ÿ     â”‚  â”‚ çŠ¶æ€ç®¡ç†     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç»„ä»¶åº“ (Components)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Footer    â”‚  â”‚  å…¶ä»–ç»„ä»¶   â”‚  â”‚  å…¶ä»–ç»„ä»¶   â”‚         â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¿è¡Œæ—¶æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Runtime.vue                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Teleport ç³»ç»Ÿ                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ Component 1 â”‚  â”‚ Component 2 â”‚  â”‚ Component N â”‚ â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç»„ä»¶ä»»åŠ¡é˜Ÿåˆ—                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ é«˜ä¼˜å…ˆçº§    â”‚  â”‚ ä¸­ä¼˜å…ˆçº§    â”‚  â”‚ ä½ä¼˜å…ˆçº§    â”‚         â”‚
â”‚  â”‚ (priority=0)â”‚  â”‚ (priority=1)â”‚  â”‚ (priority=2)â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒå®ç°åŸç†

### 1. è·¨æ ˆé€‚é…å±‚

ç³»ç»Ÿé€šè¿‡ä¸ºä¸åŒæ¡†æ¶æä¾›é€‚é…å™¨æ¥å®ç°è·¨æ ˆæ”¯æŒï¼š

#### Vue 3 é€‚é…å™¨
```typescript
// template/vue/component.ts
export default defineComponent({
  // é€šè¿‡ Vue 3 çš„ defineComponent åŒ…è£…
  // ä½¿ç”¨ Teleport å°†ç»„ä»¶æ¸²æŸ“åˆ°æŒ‡å®šä½ç½®
  render() {
    return h('div', {
      innerHTML: serverHTML,
      'data-micro-type': type
    })
  }
})
```

#### React é€‚é…å™¨
```typescript
// template/react/utils.tsx
export function getComponent({ elementId, type }) {
  return function Comp(props = {}) {
    // é€šè¿‡ React Hooks ç®¡ç†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
    // ä½¿ç”¨ dangerouslySetInnerHTML æ¸²æŸ“æœåŠ¡ç«¯å†…å®¹
    return (
      <div
        ref={el}
        dangerouslySetInnerHTML={{ __html: serverHTML.current }}
        data-micro-type={type}
      />
    )
  }
}
```

### 2. è¿è¡Œæ—¶ç³»ç»Ÿ

#### ç»„ä»¶ç®¡ç†å™¨
```typescript
// runtime/runtime.ts
export const createComponent = async (component: Component) => {
  const config = getConfig(component.type)
  
  // ä¼˜å…ˆçº§é˜Ÿåˆ—ç®¡ç†
  const task: Task = {
    priority: config.priority,
    component,
    status: 'wait'
  }
  
  // åŠ¨æ€åŠ è½½ç»„ä»¶
  const [i18nMessages, comp] = await Promise.all([
    fetchLocale(props.locale),
    fetchComponent(type),
    prefetchData(type),
    waitStyle()
  ])
  
  // æ¸²æŸ“ç»„ä»¶
  const element = document.getElementById(elementId)
  clearElementChild(element)
  
  return component.instance
}
```

#### äº‹ä»¶ç³»ç»Ÿ
```typescript
// src/compositions/useEvent.ts
export const useEvent = <Events>() => {
  const event = new EventEmitter()
  
  const emit = (eventName, ...args) => {
    // è§¦å‘äº‹ä»¶å¹¶é€šçŸ¥çˆ¶ç»„ä»¶
    eventEmit.call(event, 'event', eventName, ...args)
    eventEmit.call(event, eventName, ...args)
  }
  
  return { event, on, emit, clearEvents }
}
```

### 3. çŠ¶æ€ç®¡ç†

#### ç»„ä»¶ä½œç”¨åŸŸçŠ¶æ€
```typescript
// src/utils/store.ts
export function defineStore<T>(hook: T, options?: { global?: boolean }): T {
  return function (...args) {
    const vm = getCurrentInstance()
    let root = isGlobal ? globalRoot : findRoot(vm)
    
    // ä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºç‹¬ç«‹çš„çŠ¶æ€ä½œç”¨åŸŸ
    if (!store[uuid]) {
      const scope = effectScope(true)
      store[uuid] = {
        state: scope.run(() => hook(...args)),
        scope
      }
    }
    
    return store[uuid].state
  }
}
```

## çŠ¶æ€æµè½¬å›¾

### ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æµè½¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åˆå§‹åŒ–     â”‚â”€â”€â”€â–¶â”‚   åŠ è½½ä¸­     â”‚â”€â”€â”€â–¶â”‚   æ¸²æŸ“å®Œæˆ   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ - åˆ›å»ºä»»åŠ¡   â”‚    â”‚ - ä¸‹è½½ç»„ä»¶   â”‚    â”‚ - æŒ‚è½½DOM   â”‚
â”‚ - è®¾ç½®ä¼˜å…ˆçº§ â”‚    â”‚ - åŠ è½½è¯­è¨€åŒ… â”‚    â”‚ - ç»‘å®šäº‹ä»¶   â”‚
â”‚ - åŠ å…¥é˜Ÿåˆ—   â”‚    â”‚ - é¢„å–æ•°æ®   â”‚    â”‚ - è§¦å‘ready â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç­‰å¾…é˜Ÿåˆ—   â”‚    â”‚   é”™è¯¯çŠ¶æ€   â”‚    â”‚   æ›´æ–°çŠ¶æ€   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ - ä¼˜å…ˆçº§æ’åº â”‚    â”‚ - é”™è¯¯å¤„ç†   â”‚    â”‚ - å±æ€§æ›´æ–°   â”‚
â”‚ - ç­‰å¾…æ‰§è¡Œ   â”‚    â”‚ - é‡è¯•æœºåˆ¶   â”‚    â”‚ - é‡æ–°æ¸²æŸ“   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äº‹ä»¶é€šä¿¡çŠ¶æ€æµè½¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç»„ä»¶A      â”‚    â”‚   äº‹ä»¶æ€»çº¿   â”‚    â”‚   ç»„ä»¶B      â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ emit('click')â”‚â”€â”€â”€â–¶â”‚ EventEmitter â”‚â”€â”€â”€â–¶â”‚ on('click') â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§¦å‘äº‹ä»¶   â”‚    â”‚   äº‹ä»¶åˆ†å‘   â”‚    â”‚   æ‰§è¡Œå›è°ƒ   â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ - å‚æ•°ä¼ é€’   â”‚    â”‚ - äº‹ä»¶åŒ¹é…   â”‚    â”‚ - çŠ¶æ€æ›´æ–°   â”‚
â”‚ - ç±»å‹æ£€æŸ¥   â”‚    â”‚ - é˜Ÿåˆ—å¤„ç†   â”‚    â”‚ - UIæ›´æ–°    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ„å»ºç³»ç»Ÿ

### å¤šæ¡†æ¶æ„å»ºæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æºç  (Source)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Vue ç»„ä»¶   â”‚  â”‚   React ç»„ä»¶ â”‚  â”‚   é€šç”¨é€»è¾‘   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ„å»ºè„šæœ¬ (Build Scripts)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚build-vue3.tsâ”‚  â”‚build-react.tsâ”‚  â”‚build-runtimeâ”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è¾“å‡ºäº§ç‰© (Dist)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  vue/*.js   â”‚  â”‚ react/*.js  â”‚  â”‚ runtime.js  â”‚         â”‚
â”‚  â”‚  vue/*.css  â”‚  â”‚ react/*.css â”‚  â”‚ runtime.css â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»£ç åˆ†å‰²ç­–ç•¥

```typescript
// scripts/build-runtime.ts
const chunks = {
  vue: ['vue', 'vue-i18n'],
  axios: makeRegexp('axios'),
  'ant-design-vue': makeRegexp('ant-design-vue'),
  lodash: makeRegexp('lodash-es'),
  // æ¯ä¸ªç»„ä»¶ç”Ÿæˆç‹¬ç«‹çš„chunk
  ...components.map(component => ({
    [component]: [new RegExp(`src\/components\/${component}`)]
  }))
}
```

## ä½¿ç”¨æ–¹å¼

### Vue 3 é¡¹ç›®ä¸­ä½¿ç”¨

```vue
<template>
  <div>
    <MicroFooter 
      :theme="theme"
      :locale="locale"
      :currency-visible="true"
      :product-links="footerConfig.productLinks"
      :support-links="footerConfig.supportLinks"
      :social-links="footerConfig.socialLinks"
      :languages="footerConfig.languages"
      :currencies="footerConfig.currencies"
      @theme-change="handleThemeChange"
      @language-change="handleLanguageChange"
      @currency-change="handleCurrencyChange"
      @push="handleLinkClick"
    />
  </div>
</template>

<script setup>
import { MicroFooter } from 'micro-components/vue/Footer'

const theme = ref('light')
const locale = ref('en')

const handleThemeChange = (newTheme) => {
  theme.value = newTheme
}

const handleLanguageChange = (language) => {
  locale.value = language.locale
}

const handleCurrencyChange = (currency) => {
  console.log('Currency changed:', currency)
}

const handleLinkClick = (url, target) => {
  if (target === '_blank') {
    window.open(url, '_blank')
  } else {
    router.push(url)
  }
}
</script>
```

### React é¡¹ç›®ä¸­ä½¿ç”¨

```jsx
import { Footer } from 'micro-components/react/Footer'

function App() {
  const [theme, setTheme] = useState('light')
  const [locale, setLocale] = useState('en')

  const handleThemeChange = (newTheme) => {
    setTheme(newTheme)
  }

  const handleLanguageChange = (language) => {
    setLocale(language.locale)
  }

  const handleCurrencyChange = (currency) => {
    console.log('Currency changed:', currency)
  }

  const handleLinkClick = (url, target) => {
    if (target === '_blank') {
      window.open(url, '_blank')
    } else {
      navigate(url)
    }
  }

  return (
    <div>
      <Footer 
        theme={theme}
        locale={locale}
        currencyVisible={true}
        onThemeChange={handleThemeChange}
        onLanguageChange={handleLanguageChange}
        onCurrencyChange={handleCurrencyChange}
        onPush={handleLinkClick}
      />
    </div>
  )
}
```

### ç»„ä»¶åŠŸèƒ½ç‰¹æ€§

ç®€åŒ–åçš„Footerç»„ä»¶åŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒæ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢
2. **å›½é™…åŒ–**: æ”¯æŒå¤šè¯­è¨€åˆ‡æ¢
3. **é“¾æ¥ç®¡ç†**: äº§å“é“¾æ¥ã€æ”¯æŒé“¾æ¥ã€ç¤¾äº¤åª’ä½“é“¾æ¥
4. **å“åº”å¼è®¾è®¡**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
5. **äº‹ä»¶é€šä¿¡**: å®Œæ•´çš„äº‹ä»¶ç³»ç»Ÿï¼Œæ”¯æŒä¸çˆ¶ç»„ä»¶é€šä¿¡
6. **é…ç½®åŒ–**: æ‰€æœ‰å†…å®¹éƒ½å¯é€šè¿‡é…ç½®è‡ªå®šä¹‰

## æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: Vue 3 + TypeScript
- **æ„å»ºå·¥å…·**: Vite + Rollup
- **æ ·å¼ç³»ç»Ÿ**: UnoCSS + Less
- **çŠ¶æ€ç®¡ç†**: Vue Composition API + EffectScope
- **äº‹ä»¶ç³»ç»Ÿ**: Node.js Events
- **å›½é™…åŒ–**: Vue I18n (å¯é…ç½®å¼€å…³)
- **SSRæ”¯æŒ**: Vue Server Renderer (å¯é…ç½®å¼€å…³)
- **ä»£ç åˆ†å‰²**: Vite Plugin Chunk Split

## åŠŸèƒ½é…ç½®

### å›½é™…åŒ–åŠŸèƒ½å¼€å…³

Footerç»„ä»¶é»˜è®¤å¯ç”¨å›½é™…åŒ–åŠŸèƒ½ï¼Œå¯é€šè¿‡é…ç½®å…³é—­ï¼š

```typescript
// åœ¨Footerç»„ä»¶é…ç½®ä¸­å…³é—­å›½é™…åŒ–
const footerConfig = {
  i18nEnabled: false, // é»˜è®¤ true
  // å…¶ä»–é…ç½®...
}
```

### SSRåŠŸèƒ½å¼€å…³

SSRåŠŸèƒ½é»˜è®¤å…³é—­ï¼Œå¯é€šè¿‡é…ç½®å¯ç”¨ï¼š

```typescript
// åœ¨æ„å»ºé…ç½®ä¸­å¯ç”¨SSR
const buildConfig = {
  ssr: {
    enabled: true, // é»˜è®¤ false
    generateServerLocales: true // ç”ŸæˆæœåŠ¡ç«¯è¯­è¨€åŒ…
  }
}
```

## æ€§èƒ½ä¼˜åŒ–

1. **æŒ‰éœ€åŠ è½½**: ç»„ä»¶æŒ‰ä¼˜å…ˆçº§åŠ¨æ€åŠ è½½
2. **ä»£ç åˆ†å‰²**: æ¯ä¸ªç»„ä»¶ç‹¬ç«‹æ‰“åŒ…ï¼Œæ”¯æŒå¹¶è¡ŒåŠ è½½
3. **ç¼“å­˜ç­–ç•¥**: ç»„ä»¶å’Œè¯­è¨€åŒ…ç¼“å­˜æœºåˆ¶
4. **é¢„å–æ•°æ®**: æ”¯æŒç»„ä»¶æ•°æ®é¢„å–
5. **æ ·å¼éš”ç¦»**: CSS å‰ç¼€éš”ç¦»ï¼Œé¿å…æ ·å¼å†²çª
6. **åŠŸèƒ½æŒ‰éœ€**: å›½é™…åŒ–ã€SSRç­‰åŠŸèƒ½å¯æŒ‰éœ€å¯ç”¨ï¼Œå‡å°‘ä¸å¿…è¦çš„ä»£ç 

## å¼€å‘è°ƒè¯•

```bash
# å¼€å‘æ¨¡å¼
pnpm dev

# æ„å»ºæ‰€æœ‰ç‰ˆæœ¬
pnpm build

# åˆ›å»ºæ–°ç»„ä»¶
pnpm create-component
```

## æ€»ç»“

è¿™ä¸ªå¾®ç»„ä»¶ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æ ¸å¿ƒæœºåˆ¶å®ç°äº†è·¨æ ˆç»„ä»¶å¤ç”¨ï¼š

1. **é€‚é…å™¨æ¨¡å¼**: ä¸ºä¸åŒæ¡†æ¶æä¾›ç»Ÿä¸€çš„ç»„ä»¶æ¥å£
2. **è¿è¡Œæ—¶ç³»ç»Ÿ**: åŠ¨æ€åŠ è½½å’Œç®¡ç†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
3. **äº‹ä»¶é€šä¿¡**: åŸºäº EventEmitter çš„ç»„ä»¶é—´é€šä¿¡
4. **çŠ¶æ€éš”ç¦»**: ç»„ä»¶ä½œç”¨åŸŸå†…çš„çŠ¶æ€ç®¡ç†
5. **æ„å»ºä¼˜åŒ–**: å¤šæ¡†æ¶ä»£ç åˆ†å‰²å’ŒæŒ‰éœ€åŠ è½½
6. **åŠŸèƒ½æ¨¡å—åŒ–**: å›½é™…åŒ–ã€SSRç­‰åŠŸèƒ½å¯ç‹¬ç«‹é…ç½®ï¼Œæ”¯æŒæŒ‰éœ€å¯ç”¨

ç³»ç»Ÿè®¾è®¡å……åˆ†è€ƒè™‘äº†æ€§èƒ½ã€å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼Œé€šè¿‡åŠŸèƒ½å¼€å…³æœºåˆ¶å®ç°äº†åŠŸèƒ½çš„çµæ´»é…ç½®ï¼Œæ˜¯ä¸€ä¸ªæˆç†Ÿçš„å¾®å‰ç«¯ç»„ä»¶è§£å†³æ–¹æ¡ˆã€‚
